<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />

  <title>Class: TaskInfo</title>

  <link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

  <script src="./js/jquery.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/thickbox-compressed.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/quicksearch.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="./js/darkfish.js" type="text/javascript"
    charset="utf-8"></script>

</head>
<body class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="./lib/task_info_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/task_info.rb">lib/task_info.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">

      <!-- Parent Class -->
      
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"><a href="Object.html">Object</a></p>
        
      </div>
      

      <!-- Namespace Contents -->
      

      <!-- Method Quickref -->
      
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-i-stderr">#stderr</a></li>
          
          <li><a href="#method-i-stdout">#stdout</a></li>
          
          <li><a href="#method-i-success-3F">#success?</a></li>
          
          <li><a href="#method-i-to_json">#to_json</a></li>
          
          <li><a href="#method-i-to_s">#to_s</a></li>
          
        </ul>
      </div>
      

      <!-- Included Modules -->
      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="./images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="./AppControllerClient.html">AppControllerClient</a></li>
        
          <li><a href="./AppControllerException.html">AppControllerException</a></li>
        
          <li><a href="./BabelHelper.html">BabelHelper</a></li>
        
          <li><a href="./BadConfigurationException.html">BadConfigurationException</a></li>
        
          <li><a href="./CommonFunctions.html">CommonFunctions</a></li>
        
          <li><a href="./FileNotFoundException.html">FileNotFoundException</a></li>
        
          <li><a href="./NeptuneHelper.html">NeptuneHelper</a></li>
        
          <li><a href="./Object.html">Object</a></li>
        
          <li><a href="./TaskInfo.html">TaskInfo</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">TaskInfo</h1>

    <div id="description">
      
<p><a href="TaskInfo.html">TaskInfo</a> represents the result of a babel call,
an object with all the information that the user would be interested in
relating to their task. At the simplest level, this is just the output of
their job, but it also can includes profiling information (e.g.,
performance and cost), as well as information that may help with debugging
(e.g. info about the environment we executed the task in).</p>

    </div>

    <!-- Constants -->
    

    <!-- Attributes -->
    
    <div id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="job_data-attribute-method" class="method-detail">
        <a name="job_data"></a>
        
        <a name="job_data="></a>
        
        <div class="method-heading attribute-method-heading">
          <span class="method-name">job_data</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>A Hash consisting of the parameters that the user passed to babel().</p>
        
        </div>
      </div>
      
    </div>
    

    <!-- Methods -->
    
    <div id="public-class-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="new-method" class="method-detail ">
        <a name="method-c-new"></a>

        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(job_data)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Creates a new <a href="TaskInfo.html">TaskInfo</a> object, storing the
parameters the user gave us to invoke the job for later use. The user can
give us a Hash containing the parameters that the job was started with, or
a String that is the JSON-dumped version of that data (also obtainable from
<a href="TaskInfo.html">TaskInfo</a> objects via <a
href="TaskInfo.html#method-i-to_json">to_json</a>).</p>
          

          
          <div class="method-source-code"
            id="new-source">
<pre>
<span class="ruby-comment"># File lib/task_info.rb, line 36</span>
def initialize(job_data)
  if job_data.class == <span class="ruby-constant">String</span>
    begin
      job_data = <span class="ruby-constant">JSON</span>.load(job_data)
    rescue <span class="ruby-constant">JSON</span>::<span class="ruby-constant">ParserError</span>
      raise <span class="ruby-constant">BadConfigurationException</span>.new(<span class="ruby-string">&quot;job data not JSONable&quot;</span>)
    end
  end

  if job_data.class != <span class="ruby-constant">Hash</span>
    raise <span class="ruby-constant">BadConfigurationException</span>.new(<span class="ruby-string">&quot;job data not a Hash&quot;</span>)
  end
  <span class="ruby-ivar">@job_data</span> = job_data

  <span class="ruby-comment"># To prevent us from repeatedly grabbing (potentially) large files over the</span>
  <span class="ruby-comment"># network repeatedly, we keep a local, cached copy of the task's standard</span>
  <span class="ruby-comment"># output, error, and metadata - initially empty, but pulled in the first</span>
  <span class="ruby-comment"># time that the user asks for it. Since we expose this functionality through</span>
  <span class="ruby-comment"># the accessor methods below, we should not use attr_accessor or attr_reader</span>
  <span class="ruby-comment"># to directly expose this variables.</span>
  <span class="ruby-ivar">@output</span> = nil
  <span class="ruby-ivar">@error</span> = nil
  <span class="ruby-ivar">@metadata</span> = nil

  <span class="ruby-comment"># To prevent concurrent threads from pulling in output multiple times, we</span>
  <span class="ruby-comment"># guard access to remotely grabbing output/error/metadata with this</span>
  <span class="ruby-comment"># lock.</span>
  <span class="ruby-ivar">@lock</span> = <span class="ruby-constant">Mutex</span>.new
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
    </div>
  
    <div id="public-instance-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="stderr-method" class="method-detail ">
        <a name="method-i-stderr"></a>

        
        <div class="method-heading">
          <span class="method-name">stderr</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns a string with the standard error produced by this Babel task. While
all jobs should produce standard output, they may not produce standard
error, so it is reasonable that this could return an empty string to the
user.</p>
          

          
          <div class="method-source-code"
            id="stderr-source">
<pre>
<span class="ruby-comment"># File lib/task_info.rb, line 85</span>
def stderr
  if <span class="ruby-ivar">@error</span>.nil?
    <span class="ruby-ivar">@lock</span>.synchronize {
      <span class="ruby-ivar">@error</span> = <span class="ruby-constant">BabelHelper</span>.wait_and_get_output(<span class="ruby-ivar">@job_data</span>, <span class="ruby-ivar">@job_data</span>[<span class="ruby-string">'@error'</span>])
    }
  end

  return <span class="ruby-ivar">@error</span>
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="stdout-method" class="method-detail ">
        <a name="method-i-stdout"></a>

        
        <div class="method-heading">
          <span class="method-name">stdout</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns a string with the standard output produced by this Babel task. If
the task has not yet completed, this call blocks until it completes.</p>
          

          
          <div class="method-source-code"
            id="stdout-source">
<pre>
<span class="ruby-comment"># File lib/task_info.rb, line 69</span>
def stdout
  if <span class="ruby-ivar">@output</span>.nil?
    <span class="ruby-ivar">@lock</span>.synchronize {
      <span class="ruby-ivar">@output</span> = <span class="ruby-constant">BabelHelper</span>.wait_and_get_output(<span class="ruby-ivar">@job_data</span>,
        <span class="ruby-ivar">@job_data</span>[<span class="ruby-string">'@output'</span>])
    }
  end

  return <span class="ruby-ivar">@output</span>
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="success-3F-method" class="method-detail ">
        <a name="method-i-success-3F"></a>

        
        <div class="method-heading">
          <span class="method-name">success?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>A common operation that users may perform is asking if the task executed
successfully, indicated by a return value of zero. This method provides a
quick alias for that functionality.</p>
          

          
          <div class="method-source-code"
            id="success-3F-source">
<pre>
<span class="ruby-comment"># File lib/task_info.rb, line 105</span>
def success?
  return return_value.zero?
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="to_json-method" class="method-detail ">
        <a name="method-i-to_json"></a>

        
        <div class="method-heading">
          <span class="method-name">to_json</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Converts this object to JSON, so that it can be written to disk or passed
over the network. Since our stdout/stderr/metadata objects are all locally
cached, we don’t need to write them (and thus can potentially save a lot
of space).</p>
          

          
          <div class="method-source-code"
            id="to_json-source">
<pre>
<span class="ruby-comment"># File lib/task_info.rb, line 114</span>
def to_json
  return <span class="ruby-constant">JSON</span>.dump(<span class="ruby-ivar">@job_data</span>)
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="to_s-method" class="method-detail ">
        <a name="method-i-to_s"></a>

        
        <div class="method-heading">
          <span class="method-name">to_s</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>An alias for stdout.</p>
          

          
          <div class="method-source-code"
            id="to_s-source">
<pre>
<span class="ruby-comment"># File lib/task_info.rb, line 97</span>
def to_s
  return stdout
end</pre>
          </div>
          
        </div>

        

        
      </div>

    
    </div>
  

  </div>

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

